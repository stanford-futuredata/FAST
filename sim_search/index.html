
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.9">
    
    
      
        <title>Similarity Search - FAST</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.08040f6c.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="red">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#similarity-search" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="FAST" class="md-header__button md-logo" aria-label="FAST" data-md-component="logo">
      
  <img src="../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FAST
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Similarity Search
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/stanford-futuredata/FAST" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    FAST GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="FAST" class="md-nav__button md-logo" aria-label="FAST" data-md-component="logo">
      
  <img src="../logo.png" alt="logo">

    </a>
    FAST
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/stanford-futuredata/FAST" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    FAST GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../fast_overview/" class="md-nav__link">
        FAST Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Install
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Install" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Install
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup_colab/" class="md-nav__link">
        Google Colab
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup_linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup_docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/" class="md-nav__link">
        Tutorial
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          How to Set Parameters
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="How to Set Parameters" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          How to Set Parameters
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../FAST_checklist/" class="md-nav__link">
        FAST Checklist
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../get_seismic_data/" class="md-nav__link">
        Getting Seismic Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../input_and_preprocess/" class="md-nav__link">
        Input and Preprocessing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../f_p/" class="md-nav__link">
        Fingerprint
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Similarity Search
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Similarity Search
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hashing" class="md-nav__link">
    Hashing
  </a>
  
    <nav class="md-nav" aria-label="Hashing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#min-hash" class="md-nav__link">
    Min-Hash*
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-min-hash-signature-mhs" class="md-nav__link">
    Example: Min-Hash Signature (MHS)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lsh-example-constructing-database" class="md-nav__link">
    LSH Example: Constructing Database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity-search-in-fingerprint-database" class="md-nav__link">
    Similarity Search in Fingerprint Database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#probability-of-detection" class="md-nav__link">
    Probability of Detection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lsh-parameter-guidance" class="md-nav__link">
    LSH Parameter Guidance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-impact-of-lsh-parameters" class="md-nav__link">
    Performance Impact of LSH Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-impact-of-lsh-parameters-explanation" class="md-nav__link">
    Performance Impact of LSH Parameters (Explanation)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lsh-parameters-and-detection-results" class="md-nav__link">
    LSH Parameters and Detection Results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lsh-parameter-guidance-performance-related" class="md-nav__link">
    LSH Parameter Guidance (Performance related)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fast-similarity-search-output-format" class="md-nav__link">
    FAST Similarity Search Output Format
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../network_detection/" class="md-nav__link">
        Network Detection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../FAST_output/" class="md-nav__link">
        FAST Output
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../phase_picking/" class="md-nav__link">
        Phase Picking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../earthquake_location/" class="md-nav__link">
        Earthquake Location
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_10">
          Example Parameters
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Example Parameters" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          Example Parameters
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ex_params_intro/" class="md-nav__link">
        0.1 Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../italy_day_yr_dataset/" class="md-nav__link">
        0.2 ItalyDayYR Data Set
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tanzania_dataset/" class="md-nav__link">
        0.3 Tanzania, August 2016
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../saudi_dataset/" class="md-nav__link">
        0.4 Saudi Arabia, May 2014
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../saudifull_dataset/" class="md-nav__link">
        0.5 SaudiFull Data Set: Saudi Arabia, January - May 2017
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ometepec_dataset/" class="md-nav__link">
        0.6 Ometepec, Mexico, January - April 2012
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wenchuan_dataset/" class="md-nav__link">
        0.7 SeismOlympics: Wenchuan Aftershocks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../groningen_dataset/" class="md-nav__link">
        0.8 Groningen Data Set
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../brazil_dataset/" class="md-nav__link">
        0.9 BrazilAcre Data Set
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../newzealand_dataset/" class="md-nav__link">
        0.10 New Zealand, Year 2010
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../calipatria_dataset/" class="md-nav__link">
        0.11 Calipatria, June 2021
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../references/" class="md-nav__link">
        References
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hashing" class="md-nav__link">
    Hashing
  </a>
  
    <nav class="md-nav" aria-label="Hashing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#min-hash" class="md-nav__link">
    Min-Hash*
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-min-hash-signature-mhs" class="md-nav__link">
    Example: Min-Hash Signature (MHS)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lsh-example-constructing-database" class="md-nav__link">
    LSH Example: Constructing Database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity-search-in-fingerprint-database" class="md-nav__link">
    Similarity Search in Fingerprint Database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#probability-of-detection" class="md-nav__link">
    Probability of Detection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lsh-parameter-guidance" class="md-nav__link">
    LSH Parameter Guidance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-impact-of-lsh-parameters" class="md-nav__link">
    Performance Impact of LSH Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-impact-of-lsh-parameters-explanation" class="md-nav__link">
    Performance Impact of LSH Parameters (Explanation)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lsh-parameters-and-detection-results" class="md-nav__link">
    LSH Parameters and Detection Results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lsh-parameter-guidance-performance-related" class="md-nav__link">
    LSH Parameter Guidance (Performance related)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fast-similarity-search-output-format" class="md-nav__link">
    FAST Similarity Search Output Format
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/stanford-futuredata/FAST/edit/master/docs/sim_search.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="similarity-search"><strong>Similarity Search</strong><a class="headerlink" href="#similarity-search" title="Permanent link">&para;</a></h1>
<p><img alt="simsearch_overview" src="../img/simsearch_overview.png" />  </p>
<h2 id="hashing">Hashing<a class="headerlink" href="#hashing" title="Permanent link">&para;</a></h2>
<h3 id="min-hash">Min-Hash*<a class="headerlink" href="#min-hash" title="Permanent link">&para;</a></h3>
<p><img alt="minhash" src="../img/minhash.png" /></p>
<h3 id="example-min-hash-signature-mhs"><strong>Example:</strong> Min-Hash Signature (MHS)<a class="headerlink" href="#example-min-hash-signature-mhs" title="Permanent link">&para;</a></h3>
<p><img alt="minhash_prob" src="../img/mh_prob.png" /></p>
<p><img alt="minhash_ex" src="../img/minh_ex.png" /></p>
<h3 id="lsh-example-constructing-database">LSH Example: Constructing Database<a class="headerlink" href="#lsh-example-constructing-database" title="Permanent link">&para;</a></h3>
<p><img alt="lsh_ex" src="../img/lsh_ex.png" /></p>
<h3 id="similarity-search-in-fingerprint-database">Similarity Search in Fingerprint Database<a class="headerlink" href="#similarity-search-in-fingerprint-database" title="Permanent link">&para;</a></h3>
<p><img alt="simsearch_database" src="../img/simsearch_database.png" /></p>
<h3 id="probability-of-detection">Probability of Detection<a class="headerlink" href="#probability-of-detection" title="Permanent link">&para;</a></h3>
<p><img alt="prob_detection" src="../img/prob_detection.png" />  </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>&quot;lsh_param&quot;: {
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    &quot;ntbl&quot;: 100,        # b: Number of hash tables  
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    &quot;nhash&quot;: 4,         # r: Number of hash functions per table  
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    &quot;nvote&quot;: 2,         # v: Number of votes  
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    &quot;nthread&quot;: 8,       # Number of threads for parallel processing  
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    &quot;npart&quot;: 1,         # Number of partitions for the database  
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    &quot;repeat&quot;: 5         # Near-repeat exclusion parameter (samples)  
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>},
</code></pre></div>
<p><img alt="jaccard_sim" src="../img/jaccard_sim.png" />  </p>
<figcaption> Jaccard Similarity</figcaption>

<h3 id="lsh-parameter-guidance">LSH Parameter Guidance<a class="headerlink" href="#lsh-parameter-guidance" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><code>ntbl</code> (b): Number of hash tables</p>
<ul>
<li><strong>100</strong> is good default value</li>
</ul>
</li>
<li>
<p><code>nhash</code> (r): Number of hash functions per table  </p>
<ul>
<li><ins>Most sensitive parameter; significant effect on detection performance</ins>  </li>
<li><strong>Lower values:</strong> fewer missed detections, more false detections, longer runtime  </li>
<li><strong>Higher values:</strong> more missed detections, fewer false detections, shorter runtime  </li>
<li>Suggested values (only possibilities are 1,2,3,4,5,6,7,8):  <ul>
<li><code>nhash</code>=4 for shorter duration data sets (days – weeks)  </li>
<li><code>nhash</code>=5 for longer data sets (months – year)  </li>
<li><code>nhash</code>=6 for longest data sets (5-10 years)  </li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>nvote</code> (v): Number of votes (pair of similar fingerprints must be in same hash bucket in at least v out of b hash tables)  </p>
<ul>
<li>Can use <code>nvote</code> as threshold for single station detection  </li>
<li><code>nvote</code>=2 is good starting value; initially set low, can increase threshold later during network detection  </li>
</ul>
</li>
<li>
<p><code>repeat</code>: Near-repeat exclusion parameter  </p>
<ul>
<li>Avoid detecting any fingerprint with itself (or slight offset to itself), which is guaranteed to be similar  </li>
<li>5 samples is good default value (Multiply by <code>dt_fp</code> to get value in seconds)  </li>
</ul>
</li>
</ul>
<p><img alt="func_tables" src="../img/func_tables.png" /></p>
<figcaption>The Jaccard similarity threshold (fast increasing part of the S-curve) increases with the increase of number of hash functions (r), number of votes (v) and the decrease of number of tables (b)</figcaption>

<h3 id="performance-impact-of-lsh-parameters">Performance Impact of LSH Parameters<a class="headerlink" href="#performance-impact-of-lsh-parameters" title="Permanent link">&para;</a></h3>
<p><img alt="p_impact_1" src="../img/p_impact_1.png" />  </p>
<p><img alt="p_impact_2" src="../img/p_impact_2.png" />  </p>
<h3 id="performance-impact-of-lsh-parameters-explanation">Performance Impact of LSH Parameters (Explanation)<a class="headerlink" href="#performance-impact-of-lsh-parameters-explanation" title="Permanent link">&para;</a></h3>
<p><img alt="p_impact_ex" src="../img/p_impact_ex.png" />  </p>
<figcaption>Larger nfuncs --> more non-empty hash buckets</figcaption>

<p><img alt="p_impact_ex_2" src="../img/p_impact_ex_2.png" />  </p>
<figcaption>Larger “nfuncs” --> more non-empty hash buckets, but “largest” hash buckets are smaller (i.e. fingerprints are more “spread out” within hash table) --> faster runtime for similarity search but lower detection threshold (fingerprints must have higher Jaccard similarity for hash collisions).</figcaption>

<h3 id="lsh-parameters-and-detection-results">LSH Parameters and Detection Results<a class="headerlink" href="#lsh-parameters-and-detection-results" title="Permanent link">&para;</a></h3>
<p>The <strong>sensitivity</strong> of the FAST detector depends on the combination of <mark>nfuncs</mark> and <mark>nvotes</mark>. The table below shows how the number of detections identified by multi-station FAST on the Iquique foreshock data set from Bergen &amp; Beroza (2018a) changes as the nfuncs and nvotes parameters are varied. The first row (highlighted in blue) gives the parameter values used in Bergen &amp; Beroza (2018a).  </p>
<p><img alt="lsh_params" src="../img/lsh_params.png" />  </p>
<p>The size of the output (# of fingerprint-pairs, i.e. # non-zeros in sparse similarity matrix) of the FAST detector depends on the combination of <mark>nfuncs</mark> and <mark>nvotes</mark>.  </p>
<p>Increasing nvotes decreases the output size by increasing the detection threshold, while increasing nfuncs decreases the output size by lowering the detection threshold. Even though the number of detections for (nfuncs 5, nvotes 3) is slightly larger than for (nfuncs 8, nvotes 1), the latter has an output size that is an order of magnitude larger – this is due to a higher chance of spurious hash collisions associated with requiring only a single “vote” or collision out of 100 hash tables. Table shows output size for FAST detection results in Iquique case study from Bergen &amp; Beroza (2018a).  </p>
<p><img alt="lsh_params_2" src="../img/lsh_params_2.png" /> </p>
<p><img alt="lsh_det_1" src="../img/lsh_det_1.png" />  </p>
<figcaption>Locations of FAST detections in Kato et al (2016) template matching catalog or in local seismicity catalog (CSN) for detection with LSH parameter values: <b>nfuncs: 5</b>, <b>nvotes: 3</b></figcaption>

<p><img alt="lsh_det_2" src="../img/lsh_det_2.png" />  </p>
<figcaption>Locations of FAST detections in Kato et al (2016) template matching catalog or in local seismicity catalog (CSN) for detection with LSH parameter values: <b>nfuncs: 8</b>, <b>nvotes: 3</b></figcaption>

<p><img alt="lsh_det_3" src="../img/lsh_det_3.png" />  </p>
<figcaption>Locations of FAST detections in Kato et al (2016) template matching catalog or in local seismicity catalog (CSN) for detection with LSH parameter values: <b>nfuncs: 8</b>, <b>nvotes: 1</b></figcaption>

<h3 id="lsh-parameter-guidance-performance-related">LSH Parameter Guidance (Performance related)<a class="headerlink" href="#lsh-parameter-guidance-performance-related" title="Permanent link">&para;</a></h3>
<ul>
<li><code>ncores</code>: Number of processes for parallel processing    <ul>
<li>For large continuous data sets (&gt;months): use as many as your machine allows  </li>
<li>Runtime decreases inverse proportionally with the increase of number of threads  </li>
</ul>
</li>
</ul>
<p><img alt="lsh_guidance" src="../img/lsh_guidance.png" />  </p>
<ul>
<li><code>num_partitions</code>: Number of partitions for LSH database  <ul>
<li>LSH database can be enormous, especially for large continuous data sets  </li>
<li>FAST is intended to run on Linux clusters with lots of memory (&gt; 64 GB); figure out how much memory is on your machine  <ul>
<li>If data set is small (days-weeks), use <code>num_partitions</code>= 1 (entire database fit in memory)</li>
<li>Use num_partitions &gt; 1 for larger data sets, so that each partition fits in memory  </li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img alt="memory_usage" src="../img/memory_usage.png" /></p>
<figcaption># partitions</figcaption>

<ul>
<li><code>noise_freq</code>: (<mark>Occurrence filter</mark>) Frequency threshold above which fingerprints will be filtered out as correlated noise  <ul>
<li>Consider turning on this filter if some of the stations/channels produce orders of magnitude more outputs or take significant longer than its counterparts  </li>
<li>The slow down might be caused by the large number of matches generated from persistent background noise (see figure below as an example)  </li>
</ul>
</li>
</ul>
<p><img alt="correlated_noise" src="../img/correlated_noise.png" />  </p>
<figcaption>Example of correlated noise</figcaption>

<ul>
<li>
<p>Increase <code>num_partitions</code> to capture correlated noise that only appear in short segments of the input data  </p>
</li>
<li>
<p><strong>Example parameters</strong></p>
<ul>
<li>Input: 1 year of time series data<ul>
<li><code>noise_freq</code>=0.01  </li>
<li><code>num_partitions</code>=12  </li>
<li>Filter out fingerprints that matches over <mark>1%</mark> of other fingerprints in the current partition (partition length = 1 year / 12 = <mark>1 month</mark>)  </li>
</ul>
</li>
<li>Input: 1 month of time series data  <ul>
<li><code>noise_freq</code>=0.005  </li>
<li><code>num_partitions</code>=30  </li>
<li>Filter out fingerprints that matches over <mark>0.5%</mark> of other fingerprints in the current partition (partition length = 1 month / 30 = <mark>1 day</mark>)  </li>
</ul>
</li>
</ul>
</li>
<li>
<p>Performance benefits  </p>
<ul>
<li>Can reduce the similarity search output size by orders of magnitude as well as improve runtime  </li>
<li>Reduced output size further improves the postprocessing runtime  </li>
</ul>
</li>
</ul>
<h3 id="fast-similarity-search-output-format">FAST Similarity Search Output Format<a class="headerlink" href="#fast-similarity-search-output-format" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Naming convention for text output files  </p>
<ul>
<li>One file, regardless of npart: <code>candidate_pairs_${STATION}_${CHANNEL}_merged.txt</code>  </li>
<li><strong>Example text file (output):</strong> <code>candidate_pairs_CDY_EHZ_merged.txt</code>  </li>
</ul>
</li>
<li>
<p>Content of output file:  </p>
<ul>
<li>list of pairs of similar fingerprints and their similarity, sorted in increasing dt order: <mark>dt = index1-index2</mark>, <mark>index1</mark>, <mark>sim</mark>  </li>
<li><mark>index1</mark> is index of first fingerprint (according to global index)  </li>
<li><mark>index2</mark> is index of second fingerprint (according to global index)  </li>
<li><mark>sim</mark> is “FAST similarity”: Number of hash tables (out of b=ntbl) containing fingerprints index1 and index2 in same bucket; should be ≥ (v=nvote). Note: not normalized as the fraction divided by b.  </li>
</ul>
</li>
<li>
<p>To get fingerprint times  </p>
<ul>
<li>get global start time <mark>t0</mark> from global_idx_stats.txt, fingerprint lag <mark>dt_fp</mark> in seconds  </li>
<li><mark>time1</mark> = t0 + dt_fp * index1, <mark>time2</mark> = t0 + dt_fp * index2</li>
</ul>
</li>
</ul>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../f_p/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Fingerprint" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Fingerprint
            </div>
          </div>
        </a>
      
      
        
        <a href="../network_detection/" class="md-footer__link md-footer__link--next" aria-label="Next: Network Detection" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Network Detection
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.tabs.link"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
    
  </body>
</html>